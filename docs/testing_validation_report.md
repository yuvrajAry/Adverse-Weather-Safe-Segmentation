## IDDAW Project - Testing & Validation Report

### Environment
- OS: Windows 10
- Python: 3.x
- Torch/Torchvision: 2.3.1+cpu / 0.18.1+cpu
- Key libs: numpy 1.26.4, Pillow 10.4.0, opencv-python 4.10+

### Dataset
- Root: `IDDAW/` with `train` and `val` splits under weather folders `FOG|RAIN|SNOW|LOWLIGHT`, each with `rgb`, `nir`, `gtSeg`.
- Splits CSVs: `project/splits/{train,val}.csv` generated by `python -m project.preprocess --data_root IDDAW`.

### Models & Checkpoints
- `project/ckpts/best_rgb_mbv3.pt`
- `project/ckpts/best_nir_fastscnn.pt`
- `project/ckpts/best_early4_mbv3.pt`
- `project/ckpts/best_mid_mbv3.pt`

### Validation Commands
Run from `D:\iddaw\pro`:
```
python -m project.eval --splits_dir project/splits --ckpt project/ckpts/best_rgb_mbv3.pt     --modality rgb    --backbone mbv3     --image_size 512 --batch_size 4 --workers 4
python -m project.eval --splits_dir project/splits --ckpt project/ckpts/best_nir_fastscnn.pt --modality nir    --backbone fastscnn --image_size 512 --batch_size 4 --workers 4
python -m project.eval --splits_dir project/splits --ckpt project/ckpts/best_early4_mbv3.pt  --modality early4 --backbone mbv3     --image_size 512 --batch_size 4 --workers 4
python -m project.eval --splits_dir project/splits --ckpt project/ckpts/best_mid_mbv3.pt     --modality mid    --backbone mbv3     --image_size 512 --batch_size 4 --workers 4
```

### Validation Results (val split)
- rgb_mbv3: mIoU=0.385, Safe-mIoU=0.276
- nir_fastscnn: mIoU=0.315, Safe-mIoU=0.208
- early4_mbv3: mIoU=0.388, Safe-mIoU=0.241
- mid_mbv3: mIoU=0.372, Safe-mIoU=0.249

Note: Safe-mIoU computed using `SafetyGroups.default()` and the label mapping in `project/labels.py`.

### Visual Output Generation
```
python -m project.demo --splits_dir project/splits --ckpt project/ckpts/best_rgb_mbv3.pt     --modality rgb    --backbone mbv3     --num_samples 40 --out_dir project/outputs
python -m project.demo --splits_dir project/splits --ckpt project/ckpts/best_nir_fastscnn.pt --modality nir    --backbone fastscnn --num_samples 40 --out_dir project/outputs
python -m project.demo --splits_dir project/splits --ckpt project/ckpts/best_early4_mbv3.pt  --modality early4 --backbone mbv3     --num_samples 40 --out_dir project/outputs
python -m project.demo --splits_dir project/splits --ckpt project/ckpts/best_mid_mbv3.pt     --modality mid    --backbone mbv3     --num_samples 40 --out_dir project/outputs
```
Outputs: `project/outputs/<variant>/*_{overlay,safety,entropy,confidence}.png`.

### Testing Notes
- Fixed visualization for NIR and early4 in `project/demo.py` to avoid OpenCV channel mismatch by ensuring 3-channel overlays.
- MC Dropout entropy maps computed during eval; not saved by default.

### Recommendations
- Consider aligning `LabelMapper.default()` with the dataset taxonomy for potentially higher mIoU.
- If running on GPU, install CUDA builds of torch/torchvision for speed.
- Increase `workers` for faster dataloading on multi-core systems.


